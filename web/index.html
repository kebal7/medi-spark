<!DOCTYPE html>
<html>
<head>
    <title>Heart Disease Predictor</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
            display: flex;
            justify-content: center;
            padding: 20px;
        }
        .container {
            background-color: #fff;
            padding: 25px 40px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 100%;
        }
        h2 {
            text-align: center;
            color: #333;
        }
        form div {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 8px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        button {
            width: 48%;
            padding: 10px;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            cursor: pointer;
            margin-right: 4%;
        }
        #predictBtn { background-color: #28a745; color: #fff; }
        #randomFill { background-color: #007bff; color: #fff; }
        #result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            font-weight: bold;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Heart Disease Predictor</h2>
        <form id="predictForm">
            <div>
                <label>Age:</label>
                <input type="number" name="age" required>
            </div>
            <div>
                <label>Sex:</label>
                <select name="sex" required>
                    <option value="Male">Male</option>
                    <option value="Female">Female</option>
                </select>
            </div>
            <div>
                <label>Chest Pain Type:</label>
                <select name="cp" required>
                    <option value="typical angina">typical angina</option>
                    <option value="atypical angina">atypical angina</option>
                    <option value="non-anginal">non-anginal</option>
                    <option value="asymptomatic">asymptomatic</option>
                </select>
            </div>
            <div>
                <label>Resting BP (mm Hg):</label>
                <input type="number" name="trestbps" required>
            </div>
            <div>
                <label>Cholesterol (mg/dl):</label>
                <input type="number" name="chol" required>
            </div>
            <div>
                <label>Fasting Blood Sugar (mg/dl):</label>
                <input type="number" name="fbs" required>
            </div>
            <div>
                <label>Max Heart Rate Achieved:</label>
                <input type="number" name="thalach" required>
            </div>
            <div>
                <label>Exercise Induced Angina:</label>
                <select name="exang" required>
                    <option value="True">True</option>
                    <option value="False">False</option>
                </select>
            </div>
            <div>
                <label>Oldpeak:</label>
                <input type="number" step="0.1" name="oldpeak" required>
            </div>
            <div>
                <label>Slope of ST Segment:</label>
                <select name="slope" required>
                    <option value="upsloping">upsloping</option>
                    <option value="flat">flat</option>
                    <option value="downsloping">downsloping</option>
                </select>
            </div>
            <div>
                <label>Major Vessels (0-3):</label>
                <input type="number" name="ca" min="0" max="3" required>
            </div>
            <div>
                <label>Thalassemia:</label>
                <select name="thal" required>
                    <option value="normal">normal</option>
                    <option value="fixed defect">fixed defect</option>
                    <option value="reversible defect">reversible defect</option>
                </select>
            </div>
            <div style="display:flex; justify-content: space-between;">
                <button type="submit" id="predictBtn">Predict</button>
                <button type="button" id="randomFill">Random Fill</button>
            </div>
        </form>

        <div id="result"></div>
    </div>

    <script>
        const randomInt = (min, max) => Math.floor(Math.random() * (max - min + 1)) + min;
        const randomFloat = (min, max, step=0.1) => +(Math.random() * (max - min) + min).toFixed(1);
        const pickRandom = (arr) => arr[Math.floor(Math.random() * arr.length)];

        const resultDiv = document.getElementById("result");

        document.getElementById("predictForm").onsubmit = async function(e) {
            e.preventDefault();
            const formData = new FormData(e.target);
            const data = Object.fromEntries(formData.entries());
            data.exang = data.exang === "True";

            const response = await fetch("/predict", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify(data)
            });

            const result = await response.json();

            // Color based on risk
            let color = "green";
            if (result.risk_level === "Medium") color = "orange";
            else if (result.risk_level === "High") color = "red";

            resultDiv.style.backgroundColor = color;
            resultDiv.style.color = "#fff";

            resultDiv.innerText = 
                "Prediction: " + result.prediction + " (" + result.risk_level + " Risk)\n" +
                "Probability of Heart Disease: " + result.probability_disease + "%\n" +
                "Probability of No Heart Disease: " + result.probability_no_disease + "%";
        };

        document.getElementById("randomFill").onclick = function() {
            const form = document.getElementById("predictForm");
            form.age.value = randomInt(29, 77);
            form.sex.value = pickRandom(["Male", "Female"]);
            form.cp.value = pickRandom(["typical angina","atypical angina","non-anginal","asymptomatic"]);
            form.trestbps.value = randomInt(90, 180);
            form.chol.value = randomInt(150, 350);
            form.fbs.value = randomInt(70, 200);
            form.thalach.value = randomInt(90, 200);
            form.exang.value = pickRandom(["True", "False"]);
            form.oldpeak.value = randomFloat(0, 6);
            form.slope.value = pickRandom(["upsloping","flat","downsloping"]);
            form.ca.value = randomInt(0, 3);
            form.thal.value = pickRandom(["normal","fixed defect","reversible defect"]);
        };
    </script>
</body>
</html>

